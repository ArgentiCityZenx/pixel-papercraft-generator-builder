// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("rescript/lib/js/curry.js");
var Pages = require("./Pages.bs.js");
var React = require("react");
var Inputs = require("./Inputs.bs.js");
var Builder = require("../modules/Builder.bs.js");
var Generator = require("../modules/Generator.bs.js");
var ScriptRunner = require("../modules/ScriptRunner.bs.js");
var ResourceLoader = require("../modules/ResourceLoader.bs.js");

function GeneratorView(Props) {
  var generatorDef = Props.generatorDef;
  var match = React.useState(function () {
        
      });
  var setModel = match[1];
  var model = match[0];
  React.useEffect((function () {
          ResourceLoader.loadResources(generatorDef).then(function (results) {
                if (results.TAG === /* Ok */0) {
                  var match = results._0;
                  var model = Builder.Model.make(undefined);
                  var model$1 = match[0].reduce((function (acc, param) {
                          return Builder.addImage(acc, param[0], param[1]);
                        }), model);
                  var model$2 = match[1].reduce((function (acc, param) {
                          return Builder.addTexture(acc, param[0], param[1]);
                        }), model$1);
                  ScriptRunner.run(generatorDef, model$2).then(function (model) {
                        return Curry._1(setModel, (function (param) {
                                      return model;
                                    }));
                      });
                  return ;
                }
                console.log(results._0);
                
              });
          
        }), [generatorDef]);
  var runScript = function (model) {
    ScriptRunner.run(generatorDef, model).then(function (model) {
          return Curry._1(setModel, (function (param) {
                        return model;
                      }));
        });
    
  };
  var onInputsChange = runScript;
  var onPagesInputsChange = function (param) {
    return runScript(Generator.getModel(undefined));
  };
  return React.createElement("div", undefined, model !== undefined ? React.createElement("div", undefined, React.createElement(Inputs.make, {
                        model: model,
                        onChange: onInputsChange
                      }), React.createElement(Pages.make, {
                        generatorDef: generatorDef,
                        model: model,
                        onChange: onPagesInputsChange
                      })) : null);
}

var make = GeneratorView;

var $$default = GeneratorView;

exports.make = make;
exports.$$default = $$default;
exports.default = $$default;
exports.__esModule = true;
/* Pages Not a pure module */
